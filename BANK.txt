CREATE TABLE BRANCH
(
    BRANCH_NAME VARCHAR2(30),
    BRANCH_CITY VARCHAR2(40),
    ASSETS NUMBER(10,2),
    PRIMARY KEY(BRANCH_NAME)
);

CREATE TABLE CUSTOMER
(
    CUSTOMERNAME VARCHAR2(30),
    CUSTOMER_STREET VARCHAR2(40),
    CITY VARCHAR2(30),
    PRIMARY KEY(CUSTOMERNAME)
);

CREATE TABLE ACCOUNT1
(
    ACCNO NUMBER(20),
    BRANCH_NAME VARCHAR2(30),
    BALANCE NUMBER(8,2),
    PRIMARY KEY(ACCNO),
    FOREIGN KEY(BRANCH_NAME) REFERENCES BRANCH(BRANCH_NAME)
);

CREATE TABLE LOAN
(
    LOAN_NUMBER NUMBER(20),
    BRANCH_NAME VARCHAR2(30),
    AMOUNT NUMBER(8,2),
    PRIMARY KEY (LOAN_NUMBER),
    FOREIGN KEY(BRANCH_NAME) REFERENCES BRANCH(BRANCH_NAME)
);

CREATE TABLE BORROWER
(
    CUSTOMERNAME VARCHAR2(30),
    LOAN_NUMBER NUMBER(20),
    PRIMARY KEY (LOAN_NUMBER),
    FOREIGN KEY(CUSTOMERNAME)REFERENCES CUSTOMER(CUSTOMERNAME),
    FOREIGN KEY (LOAN_NUMBER)REFERENCES LOAN (LOAN_NUMBER)
);

CREATE TABLE DEPOSITOR
(
    CUSTOMERNAME VARCHAR2(30),
    ACCNO NUMBER(20),
    PRIMARY KEY (CUSTOMERNAME,ACCNO),
    FOREIGN KEY(CUSTOMERNAME)REFERENCES CUSTOMER(CUSTOMERNAME),
    FOREIGN KEY (ACCNO)REFERENCES ACCOUNT1 (ACCNO)
);

INSERT INTO BRANCH VALUES('SBI PD NAGAR','BANGALORE',200000);
INSERT INTO BRANCH VALUES('SBI RAJAJI NAGAR','BANGALORE',500000);
INSERT INTO BRANCH VALUES('SBI JAYANAGAR','BANGALORE',660000);
INSERT INTO BRANCH VALUES('SBI VIJAY NAGAR','BANGALORE',870000);
INSERT INTO BRANCH VALUES('SBI HOSAKEREHALLI','BANGALORE',550000);

INSERT INTO ACCOUNT1 VALUES(1234602,'SBI HOSAKEREHALLI',5000);
INSERT INTO ACCOUNT1 VALUES(1234603,'SBI VIJAY NAGAR',5000);
INSERT INTO ACCOUNT1 VALUES(1234604,'SBI JAYANAGAR',5000);
INSERT INTO ACCOUNT1 VALUES(1234605,'SBI RAJAJI NAGAR',10000);
INSERT INTO ACCOUNT1 VALUES(1234503,'SBI VIJAY NAGAR',40000);
INSERT INTO ACCOUNT1 VALUES(1234504,'SBI PD NAGAR',4000);

INSERT INTO CUSTOMER VALUES('KEZAR','M G ROAD','BANGALORE');
INSERT INTO CUSTOMER VALUES('LAL KRISHNA','ST MKS ROAD','BANGALORE');
INSERT INTO CUSTOMER VALUES('RAHUL','AUGSTEN ROAD','BANGALORE');
INSERT INTO CUSTOMER VALUES('LALLU','V S ROAD','BANGALORE');
INSERT INTO CUSTOMER VALUES('FAIZAL','RESEDENCY ROAD','BANGALORE');
INSERT INTO CUSTOMER VALUES('RAJEEV','DICKNSN ROAD','BANGALORE');

INSERT INTO LOAN VALUES(10011,'SBI JAYANAGAR',10000);
INSERT INTO LOAN VALUES(10012,'SBI VIJAY NAGAR',5000);
INSERT INTO LOAN VALUES(10013,'SBI HOSAKEREHALLI',20000);
INSERT INTO LOAN VALUES(10014,'SBI PD NAGAR',15000);
INSERT INTO LOAN VALUES(10015,'SBI RAJAJI NAGAR',25000);

INSERT INTO BORROWER VALUES('KEZAR',10011);
INSERT INTO BORROWER VALUES('LAL KRISHNA',10012);
INSERT INTO BORROWER VALUES('RAHUL',10013);
INSERT INTO BORROWER VALUES('LALLU',10014);
INSERT INTO BORROWER VALUES('LAL KRISHNA',10015);

INSERT INTO DEPOSITOR VALUES('LAL KRISHNA',1234602);
INSERT INTO DEPOSITOR VALUES('RAHUL',1234603);
INSERT INTO DEPOSITOR VALUES('RAHUL',1234503);
INSERT INTO DEPOSITOR VALUES('LALLU',1234604);
INSERT INTO DEPOSITOR VALUES('LALLU',1234504);
INSERT INTO DEPOSITOR VALUES('FAIZAL',1234605);

SELECT CUSTOMERNAME,COUNT(ACCNO) FROM DEPOSITOR GROUP BY CUSTOMERNAME
HAVING COUNT(ACCNO)>1;
